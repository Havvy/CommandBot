{"version":3,"sources":["/home/havvy/tennu/tennu/src/lib/client.sjs"],"names":["lodash","require","packagejson","defaultFactoryConfiguration","Socket","defaultClientConfiguration","undefined","Client","config","dependencies","nick","user","Error","client","Object","create","prototype","_config","freeze","defaults","di","_logger","Logger","_socket","IrcSocket","NetSocket","_messageHandler","MessageHandler","_nickname","NicknameTracker","nickname","commandHandler","CommandHandler","_subscriber","BiSubscriber","on","privmsg","parse","_plugins","Plugins","addHook","module$2","handlers","note","use","__dirname","plugins","process","cwd","_actionExports","getPlugin","out","_outputSocket","events","connected","param","connect","warn","start","disconnect","end","act","apply","arguments","ctcp","join","kick","mode","notice","part","quit","say","userhost","who","whois","raw","rawf","once","off","getModule","getRole","initializePlugin","initialize","isPluginInitializable","isInitializable","debug","info","error","crit","alert","emerg","log","level","args","Array","slice","call","module","exports"],"mappings":"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","file":"client.js","sourcesContent":["const lodash = require(\"lodash\");\nconst packagejson = require(\"../package.json\")[\"\"]\n\n// delegate x y -> function () { this.x.y.apply(this.x, arguments); return this; }\nmacro delegate {\n    rule { $property:ident $method:ident } => {\n        function () {\n            this . $property . $method . apply (this . $property , arguments);\n            return this;\n        }\n    }\n}\n\n// delegate_ret x y -> function () { return this.x.y.apply(this.x, arguments); }\nmacro delegate_ret {\n    rule { $property:ident $method:ident } => {\n        function () {\n            return this . $property . $method . apply (this . $property, arguments);\n        }\n    }\n}\n\nconst defaultFactoryConfiguration = {\n    \"NetSocket\" : require(\"net\").Socket,\n    \"IrcSocket\" : require(\"irc-socket\"),\n    \"MessageHandler\" : require(\"./message-handler.js\"),\n    \"CommandHandler\" : require(\"./command-handler.js\"),\n    \"Plugins\" : require(\"tennu-plugins\"),\n    \"BiSubscriber\" : require(\"./bisubscriber.js\"),\n    \"Logger\": require(\"./null-logger.js\"),\n    \"NicknameTracker\": require(\"./nickname-tracker.js\")\n};\n\nconst defaultClientConfiguration = {\n    // IrcSocket Config\n    \"server\": undefined,\n    \"port\": 6667,\n    \"ipv6\": undefined,\n    \"localAddress\": undefined,\n    \"secure\": false,\n    \"password\": undefined,\n    \"capab\": false,\n    \"nickname\": \"tennubot\",\n    \"username\": \"tennu\",\n    \"realname\": \"tennu \" + require(\"../package.json\")[\"version\"],\n\n    // Tennu Config\n    \"channels\": [],\n    \"nickserv\": \"nickserv\",\n    \"auth-password\": undefined,\n    \"plugins\": [],\n    \"command-trigger\": \"!\",\n    \"disable-help\": false\n};\n\n/** Fields\n * _config\n * _socket\n * _logger\n * out      (_outputSocket)\n * events   (_subscriber)\n * plugins  (_plugins)\n * nickname (_nickname)\n */\n const Client = function (config, dependencies) {\n    if (config.nick || config.user) {\n        throw new Error(\"Please use \\\"nickname\\\" and \\\"username\\\" instead of \\\"nick\\\" and \\\"user\\\" in your configuration.\");\n    }\n\n    const client = Object.create(Client.prototype);\n\n    // Parse the configuration object. Make it immutable.\n    client._config = config = Object.freeze(lodash.defaults({}, config, defaultClientConfiguration));\n    di = lodash.defaults({}, dependencies || {}, defaultFactoryConfiguration);\n\n    // Create a logger.\n    // Default logger is a bunch of NOOPs.\n    client._logger = new di.Logger();\n\n    // The socket reads and sends messages from/to the IRC server.\n    client._socket = new di.IrcSocket(config, di.NetSocket);\n\n    // Create the listener to the socket.\n    // This listener will parse the raw messages of the socket, and\n    // emits specific events to listen to.\n    client._messageHandler = new di.MessageHandler(client, client._logger, client._socket);\n\n    // Create the object that tracks the nickname of the client.\n    // Because this object is a function, it is expected that\n    // the factory function does not use `this`.\n    client._nickname = di.NicknameTracker(config.nickname, client._messageHandler);\n\n    // Create the listener to private messages from the IRCMessageEmitter\n    // The commander will parse these private messages for commands, and\n    // emit those commands, also parsed.\n    const commandHandler = new di.CommandHandler(config, client, client._nickname, client._logger);\n\n    // The subscriber handles event subscriptions to the Client object,\n    // determining whether they should be handled by the IrcMessageEmitter\n    // or the Command Handler.\n    client._subscriber = new di.BiSubscriber(client._messageHandler, commandHandler);\n    client._subscriber.on(\"privmsg\", function (privmsg) { commandHandler.parse(privmsg); });\n\n    // Configure the plugin system.\n    client._plugins = new di.Plugins(\"tennu\", client);\n    client._plugins.addHook(\"handlers\", function (module, handlers) {\n        client._subscriber.on(handlers);\n    });\n    client.note(\"Tennu\", \"Loading default plugins\");\n    client._plugins.use([\"server\", \"action\", \"help\", \"user\", \"channel\", \"startup\"], __dirname);\n    client.note(\"Tennu\", \"Loading your plugins\");\n    client._plugins.use(config.plugins || [], process.cwd());\n\n    // Grab a reference to the \"action\" plugin exports, so that the client\n    // can delegate the actions to it.\n    client._actionExports = client.getPlugin(\"action\");\n\n    client.out = client._outputSocket;\n    client.events = client._subscriber;\n    client.plugins = client._plugins;\n    client.nickname = client._nickname;\n\n    client.connected = false;\n\n    client.note(\"Tennu\", \"Client created.\");\n    return client;\n};\n\n// implements ConfigurationStorage\n\nClient.prototype.config = function (param) {\n    return this._config[param];\n};\n\n// implements Runnable ;)\n\nconst connect = function () {\n    if (this.connected) {\n        this.warn(\"Tennu\", \"Attempted to connect already connected client.\");\n        return;\n    }\n\n    this._socket.connect();\n    this.connected = true;\n    this.note(\"Tennu\", \"Connected\");\n    return this;\n}\n\nClient.prototype.connect = connect;\nClient.prototype.start = connect;\n\nconst disconnect = function () {\n    if (!this.connected) {\n        this.warn(\"Tennu\", \"Attempted to disconnect already disconnected client.\");\n        return this;\n    }\n\n    this._socket.end();\n    this.connected = false;\n    this.note(\"Tennu\", \"Disconnected\");\n    return this;\n};\n\nClient.prototype.disconnect = disconnect;\nClient.prototype.end = disconnect;\n\n// implements IRC Output Socket\nClient.prototype.act                    = delegate_ret _actionExports act;\nClient.prototype.ctcp                   = delegate_ret _actionExports ctcp;\nClient.prototype.join                   = delegate_ret _actionExports join;\nClient.prototype.kick                   = delegate_ret _actionExports kick;\nClient.prototype.mode                   = delegate_ret _actionExports mode;\nClient.prototype.nick                   = delegate_ret _actionExports nick;\nClient.prototype.notice                 = delegate_ret _actionExports notice;\nClient.prototype.part                   = delegate_ret _actionExports part;\nClient.prototype.quit                   = delegate_ret _actionExports quit;\nClient.prototype.say                    = delegate_ret _actionExports say;\nClient.prototype.userhost               = delegate_ret _actionExports userhost;\nClient.prototype.who                    = delegate_ret _actionExports who;\nClient.prototype.whois                  = delegate_ret _actionExports whois;\nClient.prototype.raw                    = delegate_ret _actionExports raw;\nClient.prototype.rawf                   = delegate_ret _actionExports rawf;\n\n// implements BiSubscriber\nClient.prototype.on                     = delegate _subscriber on;\nClient.prototype.once                   = delegate _subscriber once;\nClient.prototype.off                    = delegate _subscriber off;\n\n// implements PluginSystem\nClient.prototype.use                    = delegate     _plugins use;\nClient.prototype.getModule              = delegate_ret _plugins getPlugin;\nClient.prototype.getPlugin              = delegate_ret _plugins getPlugin\nClient.prototype.getRole                = delegate_ret _plugins getRole;\nClient.prototype.initializePlugin       = delegate     _plugins initialize;\nClient.prototype.isPluginInitializable  = delegate_ret _plugins isInitializable;\nClient.prototype.addHook                = delegate     _plugins addHook;\n\n// implements Logger\nClient.prototype.debug                  = delegate _logger debug;\nClient.prototype.info                   = delegate _logger info;\nClient.prototype.note                   = delegate _logger notice;\nClient.prototype.warn                   = delegate _logger warn;\nClient.prototype.error                  = delegate _logger error;\nClient.prototype.crit                   = delegate _logger crit;\nClient.prototype.alert                  = delegate _logger alert;\nClient.prototype.emerg                  = delegate _logger emerg;\n\nClient.prototype.log = function (level) {\n    const args = Array.prototype.slice.call(arguments, 1);\n    this._logger[level].apply(this._logger, args);\n    return this;\n};\n\n// Export the factory.\nmodule.exports = Client;"],"sourceRoot":"/source/"}