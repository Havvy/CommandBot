{"version":3,"sources":["/home/havvy/tennu/tennu/src/plugin/user.sjs"],"names":["Promise","require","format","module","exports","init","client","imports","isIdentifiedAs","nickname","accountname","debug","whois","then","result","map","whoisInfo","identified","identifiedas","toLowerCase","unwrapOr","err","error","stack"],"mappings":"AAAA,MAAMA,OAAA,GAAUC,OAAA,CAAQ,UAAR,CAAhB;AACA,MAAMC,MAAA,GAASD,OAAA,CAAQ,MAAR,EAAgBC,MAA/B,CADA;AAGAC,MAAA,CAAOC,OAAP,GAAiB;AAAA,IACbC,IAAA,EAi0CU,UAj0CMC,MAi0CN,EAj0CcC,OAi0Cd,EAj0CuB;AAAA,QAC7B,MAAMC,cAAA,GAg0CA,UAh0C0BC,QAg0C1B,EAh0CoCC,WAg0CpC,EAh0CiD;AAAA,YACnDJ,MAAA,CAAOK,KAAP,CAAa,YAAb,EAA2BT,MAAA,CAAO,wBAAP,EAAiCO,QAAjC,EAA2CC,WAA3C,CAA3B,EADmD;AAAA,YAGnD,OAAOJ,MAAA,CAAOM,KAAP,CAAaH,QAAb,EACNI,IADM,CA6zCL,UA5zCcC,MA4zCd,EA5zCsB;AAAA,gBACpB,OAAOA,MAAA,CACNC,GADM,CA2zCT,UA1zCiBC,SA0zCjB,EA1zC4B;AAAA,oBACtB,IAAIA,SAAA,CAAUC,UAAd,EAA0B;AAAA,wBACtB,OAAOD,SAAA,CAAUE,YAAV,CAAuBC,WAAvB,OAAyCT,WAAA,CAAYS,WAAZ,EAAhD,CADsB;AAAA,qBAA1B,MAEO;AAAA,wBACH,OAAO,KAAP,CADG;AAAA,qBAHe;AAAA,iBADnB,EAQNC,QARM,CAQG,KARH,CAAP,CADoB;AAAA,aADjB,EA6zCL,UAlzCWC,GAkzCX,EAlzCgB;AAAA,gBACdf,MAAA,CAAOgB,KAAP,CAAa,YAAb,EAA2BD,GAA3B,EADc;AAAA,gBAEdf,MAAA,CAAOgB,KAAP,CAAa,YAAb,EAA2BD,GAAA,CAAIE,KAA/B,EAFc;AAAA,gBAGd,OAAO,KAAP,CAHc;AAAA,aAXX,CAAP,CAHmD;AAAA,SAAvD,CAD6B;AAAA,QAsB7B,OAAO,EACHnB,OAAA,EAAS,EACLI,cAAA,EAAgBA,cADX,EADN,EAAP,CAtB6B;AAAA,KADpB;AAAA,CAAjB","file":"user.js","sourcesContent":["const Promise = require(\"bluebird\");\nconst format = require(\"util\").format;\n\nmodule.exports = {\n    init: function (client, imports) {\n        const isIdentifiedAs = function(nickname, accountname) {\n            client.debug(\"PluginUser\", format(\"isIdentifiedAs(%s, %s)\", nickname, accountname));\n\n            return client.whois(nickname)\n            .then(function (result) {\n                return result\n                .map(function (whoisInfo) {\n                    if (whoisInfo.identified) {\n                        return whoisInfo.identifiedas.toLowerCase() === accountname.toLowerCase();\n                    } else {\n                        return false;\n                    }\n                })\n                .unwrapOr(false);\n            }, function (err) {\n                client.error(\"PluginUser\", err);\n                client.error(\"PluginUser\", err.stack);\n                return false;\n            });\n        };\n\n        return {\n            exports: {\n                isIdentifiedAs: isIdentifiedAs\n            }\n        };\n    }\n};"],"sourceRoot":"/source/"}